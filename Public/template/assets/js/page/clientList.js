define(["jquery","utils","config","clientAPI","layer","pagination","remodal"],function(t,n,e,a){var i=t("[data-remodal-id=changeLineModal]").remodal(),o=t("body"),d={init:function(){this.render(),this.bindEvents()},render:function(){this.initModal(),this.initEventBind(),this.fnGetList({},!0)},bindEvents:function(){this.onSearch(),this.onStopTrade()},initEventBind:function(){n.initDatePicker()},initModal:function(){o.on("click",".J_showChangeLine",function(){var n=t(this),e=n.parents("tr").find("td"),a=e.eq(4).text(),o=e.eq(2).text(),d=e.eq(3).text(),r=t(".changeLineModal .modalForm");r.find("input[name=orgName]").val(a),r.find("input[name=nickname]").val(o),r.find("input[name=phone]").val(d),i.open()}),t(document).on("closed",".remodal",function(n){t(this).find(".modalForm")[0].reset()})},onSearch:function(){var n=this;t(".J_search").on("click",function(){var e={page:1,startTime:t("#dateStart").val(),endTime:t("#dateEnd").val(),agetId:t("input[name=org]").val(),nickname:t("input[name=nickname]").val(),memberId:t("input[name=broker]").val(),phoneNum:t("input[name=phone]").val()};n.fnGetList(e,!0)})},onStopTrade:function(){o.on("click",".J_showStopTrade",function(){var n=t(this),e=n.parents("tr").attr("data-id");n.parents("tr").find("td").eq(2).text();layer.confirm("警告！停止交易后用户能正常登录，但是无法进行交易",{},function(){a.stopTrade({id:e},function(t){layer.msg("操作成功")}),layer.msg("操作成功")})})},fnGetList:function(n,i){var o=this,d=t(".data-container table");a.getClientList(n,function(a){if(console.log("获取客户管理列表 调用成功!"),"0"==a.list.length)return d.find("tbody").empty().html("<tr><td colspan='7'>暂无记录</td></tr>"),t(".pagination").hide(),!1;var r,c='<td><input type="checkbox"></td>',s="<td><a class='text-blue' href='__ROOTHOME__/clientmanagege/clientListView/buyLog'> 查看 </a> | <a class='J_showChangeLine text-blue' href='javascript:;'> 额度 </a> | <a class='J_showStopTrade text-blue' href='javascript:;'> 停止交易 </a></td>";if(t.each(a.list,function(t,n){var a="<td>"+n.registerTime+"</td>",i="<td>"+n.nickname+"</td>",o="<td>"+n.phone+"</td>",d="<td>"+n.name+"</td>",l="<td>"+e.tradeStatus[n.status]+"</td>",u="<td>"+e.upLevel[n.upLevel]+"</td>";r+='<tr class="fadeIn animated" data-id="'+n.uid+'">'+c+a+i+o+d+u+l+s+"</tr>"}),d.find("tbody").empty().html(r),i){var l=a.totalPages;l>0&&(console.log("页数："+l),t(".pagination").show().html("").createPage({pageCount:l,current:1,backFn:function(t){var e=n;e.page=t,o.fnGetList(n)}}))}})}};d.init()});